# Windows 環境セットアップスクリプト

このスクリプト (`gemini-cli.ps1`) は、Windows環境にSSHサーバーをセットアップし、開発に必要なツール群を自動でインストール・設定します。

## 主な機能

このスクリプトは、以下のコンポーネントを自動的にセットアップします。

- **OpenSSHサーバー:**
  - 公開鍵認証のみを許可するセキュアなSSHサーバーを構築します。
  - 指定されたポートでファイアウォールルールを自動設定します。
- **PowerShell 7:**
  - 未インストールの場合、`winget`経由で自動的にインストールします。
  - SSH接続時のデフォルトシェルとして設定します。
- **Oh My Posh:**
  - プロンプトを美しく表示するテーマエンジン`Oh My Posh`をインストールします。
  - `space`テーマが適用されるようにプロファイルを自動設定します。
- **Nerd Font (Meslo):**
  - Oh My Poshの表示に必要な`MesloLGM NF`フォントのインストールを対話形式で実行します。
- **Volta:**
  - JavaScriptのツールチェインマネージャー`Volta`をインストールします。
- **Node.js & Gemini CLI:**
  - Volta経由でNode.jsのLTS（長期サポート）版をインストールします。
  - Volta経由で`@google/gemini-cli`をインストールします。

## 事前準備

1.  **管理者権限:** このスクリプトは、各種ソフトウェアのインストールやシステム設定の変更を行うため、管理者として実行する必要があります。
2.  **公開鍵の準備:** スクリプトファイルを開き、`$PUBLIC_KEY`変数に、SSH接続に使用するあなたの公開鍵（`ssh-rsa ...`で始まる文字列）を貼り付けてください。

## 実行方法

PowerShellを管理者として開き、以下のコマンドを実行します。

```powershell
# 実行ポリシーの問題を回避するため、Bypassフラグを付けて実行します。
powershell -ExecutionPolicy Bypass -File .\gemini-cli.ps1
```

スクリプトの実行中、Nerd Fontのインストールのために一度だけ対話的な操作が求められます。画面の指示に従ってください。

## 実行後の手動設定

スクリプトの完了後、Oh My Poshの表示を正しく反映させるために、**ターミナルアプリのフォント設定**が必要です。

- **Windows Terminalの場合:**
  1.  設定を開きます (`Ctrl` + `,`)。
  2.  プロファイルの「既定値」→「外観」を開きます。
  3.  「フォント フェイス」のドロップダウンから `MesloLGM NF` を選択して保存します。
